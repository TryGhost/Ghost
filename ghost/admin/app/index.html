<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
    <meta charset="UTF-8" />

    <title>Ghost</title>

    {{content-for "head"}}

    <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1, maximum-scale=1, minimal-ui, viewport-fit=cover" />
    <meta name="pinterest" content="nopin" />

    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="application-name" content="Ghost" />
    <meta name="apple-mobile-web-app-title" content="Ghost" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />

    <link rel="shortcut icon" href="assets/img/favicon.ico" />
    <link rel="apple-touch-icon" href="assets/img/apple-touch-icon.png" />

    <!-- variables that we don't want postcss-custom-properties to remove -->
    <style>
        :root {
            --editor-sidebar-width: 0px;
        }
    </style>

    <link integrity="" rel="stylesheet" href="{{rootURL}}assets/vendor.css">
    <link integrity="" rel="stylesheet" href="{{rootURL}}assets/ghost.css" title="light">

    {{content-for "head-footer"}}
</head>
<body>

    <div class="ember-load-indicator">
        <div class="gh-loading-content">
            <video id="gh-loader-video" width="100" height="100" loop autoplay muted playsinline preload="metadata" style="width: 100px; height: 100px;">
                <source id="gh-loader-source" src="assets/videos/logo-loader.mp4" type="video/mp4" />
                <div class="gh-loading-spinner"></div>
            </video>
        </div>
    </div>

    <script>
        (function() {
            // Check for dark mode preference and set appropriate video
            function updateLoaderVideo() {
                const video = document.getElementById('gh-loader-video');
                const source = document.getElementById('gh-loader-source');
                
                if (!video || !source) return;
                
                // Check system preference first
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                
                // Check for stored dark mode preference (Ghost uses nightShift setting)
                let isDarkMode = prefersDark;
                try {
                    const ghostSettings = localStorage.getItem('ghost-admin-settings');
                    if (ghostSettings) {
                        const settings = JSON.parse(ghostSettings);
                        if (settings.nightShift !== undefined) {
                            isDarkMode = settings.nightShift;
                        }
                    }
                } catch (e) {
                    // Fallback to system preference if localStorage fails
                }
                
                const videoSrc = isDarkMode ? 'assets/videos/logo-loader-dark.mp4' : 'assets/videos/logo-loader.mp4';
                
                if (source.src !== videoSrc) {
                    source.src = videoSrc;
                    video.load(); // Reload video with new source
                }
                
                // Update document class for CSS styling
                document.documentElement.classList.toggle('dark', isDarkMode);
            }
            
            // Update video on load
            updateLoaderVideo();
            
            // Listen for system preference changes
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', updateLoaderVideo);
        })();
    </script>

    {{content-for "body"}}

    {{content-for "body-footer"}}

    <script src="{{rootURL}}assets/vendor.js"></script>
    <script src="{{rootURL}}assets/ghost.js"></script>
</body>
</html>
