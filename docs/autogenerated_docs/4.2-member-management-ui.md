# Member Management UI

<details>
<summary>Relevant source files</summary>

The following files were used as context for generating this wiki page:

- [ghost/admin/.lint-todo](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/.lint-todo)
- [ghost/admin/app/components/gh-billing-update-button.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/components/gh-billing-update-button.js)
- [ghost/admin/app/components/gh-blog-url.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/components/gh-blog-url.js)
- [ghost/admin/app/components/gh-url-preview.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/components/gh-url-preview.js)
- [ghost/admin/app/components/posts-list/selection-list.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/components/posts-list/selection-list.js)
- [ghost/admin/app/controllers/pages-loading.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/controllers/pages-loading.js)
- [ghost/admin/app/controllers/pages.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/controllers/pages.js)
- [ghost/admin/app/controllers/posts-loading.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/controllers/posts-loading.js)
- [ghost/admin/app/helpers/gh-count-down-characters.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/helpers/gh-count-down-characters.js)
- [ghost/admin/app/helpers/gh-count-down-html-characters.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/helpers/gh-count-down-html-characters.js)
- [ghost/admin/app/services/members-utils.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/services/members-utils.js)
- [ghost/admin/app/templates/pages-loading.hbs](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/templates/pages-loading.hbs)
- [ghost/admin/app/templates/posts-loading.hbs](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/templates/posts-loading.hbs)

</details>



The Member Management UI is the administrative interface within Ghost's admin panel for managing and interacting with members (subscribers or readers). This interface provides functionality for viewing, creating, editing, and deleting members, as well as managing their labels, newsletter subscriptions, and payment information.

## Architecture Overview

The Member Management UI is built around a controller-route-template pattern following Ember.js conventions, with several supplementary components providing additional functionality. The system allows administrators to manage individual members as well as perform bulk operations.

```mermaid
graph TD
    subgraph "Routes"
        MembersRoute["members route"]
        MemberRoute["member route"]
        MembersLoadingRoute["members-loading route"]
    end
    
    subgraph "Controllers"
        MembersController["members controller"]
        MemberController["member controller"]
        MembersLoadingController["members-loading controller"]
    end
    
    subgraph "Templates"
        MembersTemplate["members.hbs"]
        MemberTemplate["member.hbs"]
        MembersLoadingTemplate["members-loading.hbs"]
    end
    
    subgraph "Components"
        MemberSettingsForm["gh-member-settings-form"]
        NoMembersComponent["gh-members-no-members"]
        LoadingComponent["gh-loading-spinner"]
        SelectionList["posts-list/selection-list"]
    end
    
    subgraph "Modals"
        DeleteModal["modal-delete-member"]
        ImpersonateModal["modal-impersonate-member"]
        LogoutModal["modal-logout-member"]
        LabelModal["modal-members-label-form"]
        ImportModal["modal-import-members"]
    end
    
    subgraph "Services"
        MembersUtils["members-utils"]
    end
    
    MembersRoute --> MembersController
    MemberRoute --> MemberController
    MembersLoadingRoute --> MembersLoadingController
    MembersController --> MembersTemplate
    MemberController --> MemberTemplate
    MembersLoadingController --> MembersLoadingTemplate
    MembersTemplate --> SelectionList
    MemberTemplate --> MemberSettingsForm
    MemberTemplate --> LoadingComponent
    MemberTemplate --> ImpersonateModal
    MemberTemplate --> LabelModal
    MemberController --> DeleteModal
    MemberController --> LogoutModal
    MembersController --> ImportModal
    MembersController --> MembersUtils
    MemberController --> MembersUtils
```

Sources:
- [ghost/admin/app/controllers/member.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/controllers/member.js)
- [ghost/admin/app/routes/member.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/routes/member.js)
- [ghost/admin/app/templates/member.hbs](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/templates/member.hbs)
- [ghost/admin/app/components/gh-loading-spinner.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/components/gh-loading-spinner.js)
- [ghost/admin/app/services/members-utils.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/services/members-utils.js)
- [ghost/admin/app/templates/members-loading.hbs](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/templates/members-loading.hbs)
- [ghost/admin/app/controllers/members-loading.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/controllers/members-loading.js)
- [ghost/admin/app/components/posts-list/selection-list.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/components/posts-list/selection-list.js)

## Individual Member View

The individual member view provides a detailed interface for viewing and editing a single member's information. It is implemented through the member route, controller, and template.

### Member Controller

The `MemberController` manages the following functionality:
- Fetching and saving member data
- Handling member property changes
- Managing member labels
- Confirming member deletion
- Confirming member logout
- Member impersonation

The controller maintains state for:
- Member data and changes (`dirtyAttributes`)
- Loading state
- Modal visibility states

```mermaid
classDiagram
    class MemberController {
        +member
        +isLoading
        +showImpersonateMemberModal
        +showLabelModal
        +dirtyAttributes
        +fetchMemberTask()
        +saveTask()
        +confirmDeleteMember()
        +confirmLogoutMember()
        +toggleImpersonateMemberModal()
        +setProperty()
    }
    
    class MemberRoute {
        +model(params)
        +setupController()
        +willTransition()
        +confirmUnsavedChanges()
    }
    
    class MembersUtilsService {
        +isMembersEnabled
        +paidMembersEnabled
        +isMembersInviteOnly
        +hasMultipleTiers
        +hasActiveTiers
        +fetch()
        +reload()
        +isStripeEnabled
    }
    
    MemberController --> MemberRoute : "interacts with"
    MemberController --> MembersUtilsService : "uses"
```

Sources:
- [ghost/admin/app/controllers/member.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/controllers/member.js)
- [ghost/admin/app/routes/member.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/routes/member.js)
- [ghost/admin/app/services/members-utils.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/services/members-utils.js)

### Member Template

The member template (`member.hbs`) provides the UI structure for the individual member view, consisting of:

1. A header section with:
   - Breadcrumb navigation
   - Member name/title
   - Action buttons (save, impersonate, logout, delete)

2. A form section containing the `gh-member-settings-form` component which handles:
   - Basic member information (name, email)
   - Member notes
   - Label management
   - Newsletter subscriptions
   - Subscription status

3. Modal components for specific actions:
   - Impersonate member
   - Label management

Sources:
- [ghost/admin/app/templates/member.hbs](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/templates/member.hbs)
- [ghost/admin/app/styles/layouts/members.css:676-1059](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/styles/layouts/members.css#L676-L1059)

## Member UI Styling

The Member UI uses a dedicated CSS file for styling that handles:

1. Member avatar styling:
   - Gravatar integration
   - Member initials display
   - Avatar sizing and positioning

2. Member detail layout:
   - Information sections
   - Metadata display
   - Stats and activity visualizations

3. Responsive design:
   - Mobile adaptations
   - Tablet/desktop layouts

```mermaid
flowchart TD
    subgraph "Member UI Styling Structure"
        MembersCSS["layouts/members.css"]
        AppCSS["app.css"]
        AppDarkCSS["app-dark.css"]
        
        subgraph "CSS Sections"
            AvatarStyling["Member Avatars"]
            ListStyling["Members List"]
            DetailStyling["Member Details"]
            EmptyStyling["Empty States"]
            ImportStyling["Import UI"]
        end
        
        AppCSS -->|"imports"| MembersCSS
        AppDarkCSS -->|"overrides"| MembersCSS
        MembersCSS --> AvatarStyling
        MembersCSS --> ListStyling
        MembersCSS --> DetailStyling
        MembersCSS --> EmptyStyling
        MembersCSS --> ImportStyling
    end
```

Sources:
- [ghost/admin/app/styles/layouts/members.css](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/styles/layouts/members.css)
- [ghost/admin/app/styles/app.css:61](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/styles/app.css#L61)
- [ghost/admin/app/styles/app-dark.css:982-1070](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/styles/app-dark.css#L982-L1070)

## Member Management UI Components

### Loading States

The Member Management UI implements dedicated loading states to provide visual feedback during data fetching operations. This is handled through:

1. **Loading Routes and Controllers**: Dedicated loading routes (`members-loading`) that display while data is being fetched
2. **Loading Components**: The `gh-loading-spinner` component that provides visual feedback

```mermaid
graph TD
    subgraph "Loading State System"
        LoadingRoute["members-loading route"]
        LoadingController["members-loading controller"]
        LoadingTemplate["members-loading.hbs"]
        LoadingComponent["gh-loading-list component"]
        SpinnerComponent["gh-loading-spinner component"]
    end
    
    subgraph "Data Flow"
        UserAction["User navigates to members"]
        DataFetch["Data fetching begins"]
        ShowLoading["Show loading UI"]
        DataComplete["Data fetch completes"]
        ShowContent["Show members content"]
    end
    
    UserAction --> DataFetch
    DataFetch --> ShowLoading
    ShowLoading --> LoadingRoute
    LoadingRoute --> LoadingController
    LoadingController --> LoadingTemplate
    LoadingTemplate --> LoadingComponent
    LoadingComponent --> SpinnerComponent
    DataComplete --> ShowContent
```

The loading controllers maintain references to their parent controllers to access filter states and other UI configuration:

```javascript
// Example from members-loading controller
@controller('members') postsController;

get availableTypes() {
    return this.postsController.availableTypes;
}
```

### Empty State

The `gh-members-no-members` component provides a helpful interface when no members exist in the system. It includes:
- Explanatory text
- "Add yourself" functionality
- Visual cues for getting started

### Selection System

The `posts-list/selection-list` component provides functionality for selecting multiple members for bulk operations. Key features include:

- Tracking selected items with a Set of IDs
- Support for shift-click to select ranges
- Inverted selection mode for "select all except"
- Generation of NQL filters for API requests

```mermaid
classDiagram
    class SelectionList {
        +selectedIds: Set
        +inverted: boolean
        +lastSelectedId: string
        +lastShiftSelectionGroup: Set
        +enabled: boolean
        +infinityModel: Object
        +filter: string
        +allFilter: string
        +availableModels: Array
        +count: number
        +toggleItem(id)
        +shiftItem(id)
        +selectAll()
        +clearSelection()
        +isSelected(id)
    }
```

### Modals

Several modal components provide specialized interfaces:

1. `modal-impersonate-member`: Generates a magic sign-in link to impersonate a member
2. `modal-members-label-form`: Interface for creating, editing, and deleting labels
3. `modal-delete-member`: Confirmation for member deletion
4. `modal-logout-member`: Confirmation for signing out a member from all devices
5. `modal-import-members`: Interface for importing members from CSV files

Sources:
- [ghost/admin/app/components/gh-members-no-members.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/components/gh-members-no-members.js)
- [ghost/admin/app/components/gh-loading-spinner.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/components/gh-loading-spinner.js)
- [ghost/admin/app/components/gh-loading-spinner.hbs](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/components/gh-loading-spinner.hbs)
- [ghost/admin/app/components/modal-impersonate-member.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/components/modal-impersonate-member.js)
- [ghost/admin/app/components/modal-members-label-form.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/components/modal-members-label-form.js)
- [ghost/admin/app/components/posts-list/selection-list.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/components/posts-list/selection-list.js)
- [ghost/admin/app/templates/posts-loading.hbs](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/templates/posts-loading.hbs)
- [ghost/admin/app/templates/pages-loading.hbs](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/templates/pages-loading.hbs)
- [ghost/admin/app/controllers/posts-loading.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/controllers/posts-loading.js)
- [ghost/admin/app/controllers/pages-loading.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/controllers/pages-loading.js)
- [ghost/admin/app/components/modal-import-members.hbs](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/components/modal-import-members.hbs)

## Member Management UI Interaction Patterns

The following diagram illustrates the typical interaction patterns when using the Member Management UI:

```mermaid
sequenceDiagram
    participant Admin as Administrator
    participant UI as Member UI
    participant Controller as MemberController
    participant Utils as MembersUtils
    participant API as Ghost API
    
    Admin->>UI: Navigate to member detail
    UI->>Controller: fetchMemberTask()
    Controller->>API: queryRecord('member')
    API-->>Controller: member data
    Controller-->>UI: Update UI
    
    Admin->>UI: Edit member property
    UI->>Controller: setProperty()
    Controller->>Controller: _saveMemberProperty()
    
    Admin->>UI: Click save
    UI->>Controller: saveTask()
    Controller->>API: member.save()
    API-->>Controller: saved member
    Controller-->>UI: Show success
    
    Admin->>UI: Click impersonate
    UI->>Controller: toggleImpersonateMemberModal()
    Controller-->>UI: Show modal
    UI->>API: fetchSigninUrl
    API-->>UI: signin URL
    UI-->>Admin: Display signin URL
    
    Admin->>UI: Navigate to members list
    UI->>Utils: fetch()
    Utils->>API: query('tier')
    API-->>Utils: tier data
    Utils-->>UI: Update UI with tier information
```

The Member Management UI also implements bulk selection and operations:

```mermaid
sequenceDiagram
    participant Admin as Administrator
    participant UI as Members List UI
    participant Selection as SelectionList
    participant Controller as MembersController
    participant API as Ghost API
    
    Admin->>UI: Select member (click)
    UI->>Selection: toggleItem(id)
    Selection->>Selection: Update selectedIds
    Selection-->>UI: Update selection UI
    
    Admin->>UI: Shift+click another member
    UI->>Selection: shiftItem(id)
    Selection->>Selection: Select range between last and current
    Selection-->>UI: Update selection UI
    
    Admin->>UI: Select all (Cmd+A)
    UI->>Selection: selectAll()
    Selection->>Selection: Toggle inverted state
    Selection-->>UI: Update selection UI
    
    Admin->>UI: Bulk action (delete/edit)
    UI->>Controller: bulkAction()
    Controller->>Selection: Get filter
    Selection-->>Controller: NQL filter string
    Controller->>API: API request with filter
    API-->>Controller: Response
    Controller-->>UI: Update UI
```

Sources:
- [ghost/admin/app/controllers/member.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/controllers/member.js)
- [ghost/admin/app/services/members-utils.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/services/members-utils.js)
- [ghost/admin/app/components/posts-list/selection-list.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/components/posts-list/selection-list.js)

## Integration with Other Ghost Systems

The Member Management UI integrates with several other Ghost systems through the `members-utils` service, which provides a centralized way to access member-related functionality:

```mermaid
graph TD
    subgraph "Member Management UI"
        MemberController["Member Controller"]
        MembersController["Members Controller"]
        MemberComponents["Member UI Components"]
    end
    
    subgraph "Services"
        MembersUtils["members-utils service"]
        Settings["settings service"]
        Feature["feature service"]
        Session["session service"]
        Store["store service"]
    end
    
    subgraph "External Systems"
        MembersAPI["Members API"]
        StripeIntegration["Stripe Integration"]
        TierSystem["Membership Tiers"]
        NewsletterSystem["Newsletter System"]
    end
    
    MemberController --> MembersUtils
    MembersController --> MembersUtils
    MemberComponents --> MembersUtils
    
    MembersUtils --> Settings
    MembersUtils --> Feature
    MembersUtils --> Session
    MembersUtils --> Store
    
    MembersUtils --> MembersAPI
    MembersUtils --> StripeIntegration
    MembersUtils --> TierSystem
    MembersUtils --> NewsletterSystem
```

The `members-utils` service provides key functionality:

1. **Membership Status Checks**:
   - `isMembersEnabled`: Whether the members feature is enabled
   - `paidMembersEnabled`: Whether paid memberships are enabled
   - `isMembersInviteOnly`: Whether membership is invite-only

2. **Tier Management**:
   - `hasMultipleTiers`: Whether multiple payment tiers are configured
   - `hasActiveTiers`: Whether any active payment tiers exist
   - `fetch()`: Loads tier information
   - `reload()`: Refreshes tier information

3. **Stripe Integration**:
   - `isStripeEnabled`: Whether Stripe is properly configured
   - Checks for direct keys or connect keys

4. **Plan Helpers**:
   - `isFreeChecked`: Whether free plans are enabled
   - `isMonthlyChecked`: Whether monthly plans are enabled
   - `isYearlyChecked`: Whether yearly plans are enabled

Sources:
- [ghost/admin/app/services/members-utils.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/services/members-utils.js)
- [ghost/admin/app/controllers/member.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/controllers/member.js)
- [ghost/admin/app/styles/layouts/members.css](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/styles/layouts/members.css)

## Utility Components and Helpers

The Member Management UI utilizes several utility components and helpers to enhance functionality:

### URL Preview

The `gh-url-preview` component generates and displays preview URLs for member-related pages:

```javascript
// Example usage
<GhUrlPreview @prefix="member" @slug={{member.slug}} @tagName="p" @classNames="description" />
```

The component strips the scheme from the blog URL and constructs a preview URL based on the provided prefix and slug.

### Character Counting

Two helper functions assist with character counting in member forms:

1. `gh-count-down-characters`: Counts characters in plain text fields
2. `gh-count-down-html-characters`: Counts characters in HTML content, stripping tags first

```javascript
// HTML character counting process
content = content.replace(/<[^>]*>?/gm, '');
content = content.replace(/&nbsp;/g, ' ');
content = content.replace(/&amp;/g, '&');
content = content.replace(/&quot;/g, '"');
content = content.replace(/&lt;/g, '<');
content = content.replace(/&gt;/g, '>');
```

These helpers provide visual feedback on character limits in forms, changing color when limits are approached or exceeded.

### Billing Integration

The `gh-billing-update-button` component provides integration with Ghost's billing system:

```javascript
// Opens the billing window when clicked
@action
openBilling() {
    this.billing.openBillingWindow(this.router.currentURL, '/pro/billing/plans');
}
```

## Responsive Design

The Member Management UI implements responsive design to adapt to different screen sizes:

1. **Desktop**: Full layout with all columns visible
2. **Tablet**: Simplified layout with some columns hidden
3. **Mobile**: Highly simplified layout with essential information only

Media queries in the CSS handle these adaptations, ensuring the UI remains usable across devices.

| Screen Size | Adaptations |
|-------------|-------------|
| > 1200px | Full layout with all details |
| 800px - 1200px | Simplified header, collapsed member details |
| < 800px | Mobile optimized view, stacked layout, hidden secondary information |

Sources:
- [ghost/admin/app/styles/layouts/members.css](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/styles/layouts/members.css)
- [ghost/admin/app/styles/layouts/main.css](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/styles/layouts/main.css)
- [ghost/admin/app/components/gh-url-preview.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/components/gh-url-preview.js)
- [ghost/admin/app/helpers/gh-count-down-characters.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/helpers/gh-count-down-characters.js)
- [ghost/admin/app/helpers/gh-count-down-html-characters.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/helpers/gh-count-down-html-characters.js)
- [ghost/admin/app/components/gh-billing-update-button.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/components/gh-billing-update-button.js)
- [ghost/admin/app/components/gh-blog-url.js](https://github.com/TryGhost/Ghost/blob/0d0e5bd3/ghost/admin/app/components/gh-blog-url.js)

## Summary